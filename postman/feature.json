{
	"info": {
		"_postman_id": "59cf16d7-27b6-4646-969d-98a5aae77c69",
		"name": "feature comments",
		"description": "# ‚õìÔ∏è Get started here\n\nPostman allows you to test your APIs using simple Javascript code. You can evaluate your response body, headers, cookies, and more using the [ChaiJS BDD](https://www.chaijs.com/api/bdd/) syntax.\n\nThis template guides you through the process of setting up an integration test to ensure that all individual components of an API function together seamlessly.\n\nThe API under test in this collection includes three endpoints for registering and receiving a token, accessing your unique generated name, and unregistering a token:\n\n- POST `/register`\n- POST `/unregister`\n- GET `/my-name`\n    \n\nBy setting up requests in the order of the operation, we can test the flow of data to and from the endpoints and ensure they work together as expected. We also verify that the data persists between requests on the back end.\n\n## üîñ **How to use this template**\n\n**Step 1:** Check out the requests' documentation to learn more about -\n\n- what each request is meant to do.\n- the tests we've added against each one.\n    \n\n**Step 2:** Run this collection by clicking on \"Run\".\n\n<img src=\"https://content.pstmn.io/84019b0f-69c8-4c5f-98b9-2c90a6f9a0b1/Y29sbGVjdGlvbi1ydW5uZXItYnV0dG9uLmpwZWc=\" alt=\"\" height=\"103\" width=\"266\">\n\n**Step 3:** To customize this template, replace the request URLs with your API endpoints and add or edit the tests if needed.\n\n## ‚ÑπÔ∏è Resources\n\n[Scripting in Postman](https://learning.postman.com/docs/writing-scripts/intro-to-scripts/)\n\n[Test script examples](https://learning.postman.com/docs/writing-scripts/script-references/test-examples/)\n\n[Postman Sandbox API reference](https://learning.postman.com/docs/sending-requests/grpc/postman-sandbox-api/#writing-assertions)\n\n[Using the Collection Runner](https://learning.postman.com/docs/collections/running-collections/intro-to-collection-runs/)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "27353933"
	},
	"item": [
		{
			"name": "Admin",
			"item": [
				{
					"name": "Get pending comments by admin",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        const pendingComment1 = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        const pendingComment2 = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        let accpetedComment = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        accpetedComment = await api.acceptComment(accpetedComment);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 200 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(200);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const comments = pm.response.json();",
									"",
									"pm.test(",
									"        \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –ø–æ–ª—è–º–∏:  id, text, eventId, author, createdOn, state\", ",
									"        () => {",
									"                pm.expect(comments).to.be.an(\"array\");",
									"                comments.forEach(comment => {",
									"                        pm.expect(comment).to.have.keys('id','text','eventId', 'author', 'createdOn', 'state').and.be.an(\"object\")",
									"                });",
									"        }",
									");",
									"",
									"pm.test(",
									"        \"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Å—Ç–∞—Ç—É—Å 'PENDING'\",",
									"        () => {",
									"                comments.forEach(comment => {",
									"                        pm.expect(comment.state).equal('PENDING');",
									"                })",
									"        }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/comments/pending",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"comments",
								"pending"
							]
						}
					},
					"response": []
				},
				{
					"name": "Reject comment",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        const comment = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        pm.collectionVariables.set('comment', comment);",
									"        pm.collectionVariables.set('commentId', comment.id);",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 200 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(200);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const createdComment = pm.collectionVariables.get('comment');",
									"const target = pm.response.json();",
									"",
									"pm.collectionVariables.set('createdComment', target);",
									"pm.collectionVariables.set('commentId', target.id);",
									"",
									"pm.test(",
									"    \"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: id, text, eventId, author, createdOn, state\", ",
									"    () => {",
									"        pm.expect(target).to.have.property('id');",
									"        pm.expect(target).to.have.property('text');",
									"        pm.expect(target).to.have.property('createdOn');",
									"        pm.expect(target).to.have.property('eventId');",
									"        pm.expect(target).to.have.property('author');",
									"    }",
									");",
									"",
									"pm.test(",
									"    \"–î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º –≤ –∑–∞–ø—Ä–æ—Å–µ\",",
									"    () => {",
									"        pm.expect(target.id).to.not.be.null;",
									"        pm.expect(target.text).equal(createdComment.text, '–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏');",
									"        pm.expect(target.eventId).equal(createdComment.eventId);",
									"        pm.expect(target.author.id).equal(createdComment.author.id);",
									"        pm.expect(target.state).equal('REJECTED');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/comments/:commentId/REJECTED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"comments",
								":commentId",
								"REJECTED"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Accept comment",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        const comment = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        pm.collectionVariables.set('comment', comment);",
									"        pm.collectionVariables.set('commentId', comment.id);",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 200 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(200);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const createdComment = pm.collectionVariables.get('comment');",
									"const target = pm.response.json();",
									"",
									"pm.collectionVariables.set('createdComment', target);",
									"pm.collectionVariables.set('commentId', target.id);",
									"",
									"pm.test(",
									"    \"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: id, text, eventId, author, createdOn, state\", ",
									"    () => {",
									"        pm.expect(target).to.have.property('id');",
									"        pm.expect(target).to.have.property('text');",
									"        pm.expect(target).to.have.property('createdOn');",
									"        pm.expect(target).to.have.property('eventId');",
									"        pm.expect(target).to.have.property('author');",
									"    }",
									");",
									"",
									"pm.test(",
									"    \"–î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º –≤ –∑–∞–ø—Ä–æ—Å–µ\",",
									"    () => {",
									"        pm.expect(target.id).to.not.be.null;",
									"        pm.expect(target.text).equal(createdComment.text, '–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏');",
									"        pm.expect(target.eventId).equal(createdComment.eventId);",
									"        pm.expect(target.author.id).equal(createdComment.author.id);",
									"        pm.expect(target.state).equal('ACCEPTED');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/comments/:commentId/ACCEPTED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"comments",
								":commentId",
								"ACCEPTED"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Accept comment Copy",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 409 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(409);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const error = pm.response.json();",
									"",
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: message, status, timestamp\",",
									"    () => {",
									"        pm.expect(error).to.have.property('status');",
									"        pm.expect(error).to.have.property('message');",
									"        pm.expect(error).to.have.property('timestamp');",
									"    }",
									");",
									"",
									"pm.test(",
									"    \"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –µ–π\",",
									"    () => {",
									"        pm.expect(error.message).equal(\"You cannot change state of a comment if it is not PENDING.\");",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/comments/:commentId/ACCEPTED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"comments",
								":commentId",
								"ACCEPTED"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete comment by admin",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser());",
									"        const comment = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        console.log(comment);",
									"        pm.collectionVariables.set('commentId', comment.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 204 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(204);  ",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/admin/comments/:commentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"admin",
								"comments",
								":commentId"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Private",
			"item": [
				{
					"name": "Create comment with null text",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 400 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(400);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ApiError\",",
									"    () => {",
									"        pm.expect(target).to.have.property('status');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"text\": null\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/events/:eventId/comments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"events",
								":eventId",
								"comments"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create comment with empty text",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 400 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\",",
									"    () => {",
									"        pm.response.to.have.status(400);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ApiError\",",
									"    () => {",
									"        pm.expect(target).to.have.property('status');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"text\": \"  \"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/events/:eventId/comments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"events",
								":eventId",
								"comments"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create comment for event that is not published",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 409 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\",",
									"    () => {",
									"        pm.response.to.have.status(409);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ApiError\",",
									"    () => {",
									"        pm.expect(target).to.have.property('status');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"text\": \"Nice event!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/events/:eventId/comments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"events",
								":eventId",
								"comments"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create comment for event that does not exist",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id + 1);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 404 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\",",
									"    () => {",
									"        pm.response.to.have.status(404);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ApiError\",",
									"    () => {",
									"        pm.expect(target).to.have.property('status');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"text\": \"Nice comment!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/events/:eventId/comments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"events",
								":eventId",
								"comments"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create comment",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        pm.collectionVariables.set('commenterId', commenter.id);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 201 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(201);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"});",
									"",
									"const source = JSON.parse(pm.request.body.raw);",
									"const target = pm.response.json();",
									"",
									"pm.collectionVariables.set('createdComment', target);",
									"pm.collectionVariables.set('commentId', target.id);",
									"",
									"pm.test(",
									"    \"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: id, text, eventId, author, createdOn, state\", ",
									"    () => {",
									"        pm.expect(target).to.have.property('id');",
									"        pm.expect(target).to.have.property('text');",
									"        pm.expect(target).to.have.property('createdOn');",
									"        pm.expect(target).to.have.property('eventId');",
									"        pm.expect(target).to.have.property('author');",
									"    })",
									";",
									"",
									"pm.test(",
									"    \"–î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º –≤ –∑–∞–ø—Ä–æ—Å–µ\",",
									"    () => {",
									"        pm.expect(target.id).to.not.be.null;",
									"        pm.expect(target.text).equal(source.text, '–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—É –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ');",
									"        pm.expect(target.eventId).equal(parseInt(pm.collectionVariables.get('eventId')));",
									"        pm.expect(target.author.id).equal(parseInt(pm.collectionVariables.get('commenterId')));",
									"        pm.expect(target.state).equal('PENDING');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"text\":\"Nice event!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/events/:eventId/comments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"events",
								":eventId",
								"comments"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Verify comment creation",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 200 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(200);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: id, text, eventId, author, createdOn, state\", ",
									"     () => {",
									"        pm.expect(target).to.have.property('id');",
									"        pm.expect(target).to.have.property('text');",
									"        pm.expect(target).to.have.property('eventId');",
									"        pm.expect(target).to.have.property('author');",
									"        pm.expect(target).to.have.property('createdOn');",
									"        pm.expect(target).to.have.property('state');",
									"    }",
									");",
									"",
									"const createdComment = pm.collectionVariables.get('createdComment');",
									"",
									"pm.test(",
									"    \"–î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º –≤ –∑–∞–ø—Ä–æ—Å–µ\", ",
									"    () => {",
									"        pm.expect(target.id).to.not.be.null;",
									"        pm.expect(target.text).equal(createdComment.text, '–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—É –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ');",
									"        pm.expect(target.eventId).equal(createdComment.eventId);",
									"        pm.expect(target.author.id).equal(createdComment.author.id);",
									"        pm.expect(target.state).equal('PENDING');",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/comments/:commentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"comments",
								":commentId"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Try to delete comment not by author",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        pm.collectionVariables.set('fakeCommenterId', user.id);",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 403 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(403);  ",
									"    }",
									");",
									"",
									"const error = pm.response.json();",
									"",
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å ApiError —Å –ø–æ–ª—è–º–∏: status, message, timestamp, reason\",",
									"    () => {",
									"        pm.expect(error).to.have.property('status');",
									"        pm.expect(error).to.have.property('message');",
									"        pm.expect(error).to.have.property('timestamp');",
									"        pm.expect(error).to.have.property('reason');",
									"    }",
									");",
									"",
									"pm.test(",
									"    \"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º\",",
									"    () => {",
									"        pm.expect(error.message).equal(\"You cannot delete comments of other users.\");",
									"    }",
									")"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/comments/:commentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"comments",
								":commentId"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{fakeCommenterId}}"
								},
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete comment",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 204 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(204);  ",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/:authorId/comments/:commentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								":authorId",
								"comments",
								":commentId"
							],
							"variable": [
								{
									"key": "authorId",
									"value": "{{commenterId}}"
								},
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Verify comment deletion",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 404 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\",",
									"    () => {",
									"        pm.response.to.have.status(404);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const target = pm.response.json();",
									"",
									"pm.test(",
									"    \"–í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ApiError\", ",
									"     () => {",
									"        pm.expect(target).to.have.property('status');",
									"        pm.expect(target).to.have.property('message');",
									"    }",
									");",
									"",
									"pm.test(",
									"    \"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–æ—Ä–µ–µ–∫—Ç–Ω—ã–º\", ",
									"    () => {",
									"        pm.expect(target.message).equal(\"Could not find the requested comment.\");",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/comments/:commentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"comments",
								":commentId"
							],
							"variable": [
								{
									"key": "commentId",
									"value": "{{commentId}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Comments integration with events",
			"item": [
				{
					"name": "Get event by id with only accepted comments",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const main = async () => {",
									"    const api = new API(pm);",
									"    const rnd = new RandomUtils();",
									"",
									"    try {",
									"        const user = await api.addUser(rnd.getUser());",
									"        const category = await api.addCategory(rnd.getCategory());",
									"        let event = await api.addEvent(user.id, rnd.getEvent(category.id));",
									"        event = await api.publishEvent(event.id);",
									"        const commenter = await api.addUser(rnd.getUser())",
									"        const pendingComment1 = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        let acceptedComment = await api.addComment(rnd.getComment(), commenter.id, event.id);",
									"        acceptedComment = await api.acceptComment(acceptedComment);",
									"        pm.collectionVariables.set('eventId', event.id);",
									"        pm.collectionVariables.set('response', event);",
									"",
									"    } catch(err) {",
									"        console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.\", err);",
									"    }",
									"};",
									"",
									"const interval = setInterval(() => {}, 1000);",
									"",
									"setTimeout(async () => ",
									"    {",
									"        try {",
									"            // –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç",
									"            await main();",
									"        } catch (e) {",
									"            console.error(e);",
									"        } finally {",
									"            clearInterval(interval);",
									"        }",
									"    },  ",
									"    100 ",
									");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(",
									"    \"–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ 200 –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json\", ",
									"    () => {",
									"        pm.response.to.have.status(200);  ",
									"        pm.response.to.be.withBody;",
									"        pm.response.to.be.json;",
									"    }",
									");",
									"",
									"const source = pm.collectionVariables.get('response');",
									"const target = pm.response.json();",
									"",
									"",
									"pm.test(",
									"        \"–°–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è: id, title, annotation, category, paid, eventDate, initiator, views, confirmedRequests, description, participantLimit, state, createdOn, publishedOn, location, requestModeration, comments\",",
									"        () => {",
									"                pm.expect(target).to.have.property('id');",
									"                pm.expect(target).to.have.property('title');",
									"                pm.expect(target).to.have.property('annotation');",
									"                pm.expect(target).to.have.property('category');",
									"                pm.expect(target).to.have.property('paid');",
									"                pm.expect(target).to.have.property('eventDate');",
									"                pm.expect(target).to.have.property('initiator');",
									"                pm.expect(target).to.have.property('views');",
									"                pm.expect(target).to.have.property('confirmedRequests');",
									"                pm.expect(target).to.have.property('description');",
									"                pm.expect(target).to.have.property('participantLimit');",
									"                pm.expect(target).to.have.property('state');",
									"                pm.expect(target).to.have.property('createdOn');",
									"                pm.expect(target).to.have.property('publishedOn');",
									"                pm.expect(target).to.have.property('location');",
									"                pm.expect(target).to.have.property('requestModeration');",
									"                pm.expect(target).to.have.property('comments');",
									"        }",
									");",
									"",
									"const comments = target.comments;",
									"",
									"pm.test(",
									"        \"–°–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –ø–æ–ª—è–º–∏:  id, text, eventId, author, createdOn, state\", ",
									"        () => {",
									"                console.log(comments);",
									"                pm.expect(comments).to.be.an(\"array\");",
									"                comments.forEach(comment => {",
									"                        pm.expect(comment).to.have.keys('id','text','eventId', 'author', 'createdOn', 'state').and.be.an(\"object\")",
									"                });",
									"        }",
									");",
									"",
									"",
									"pm.test(",
									"        \"–î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º –≤ –∑–∞–ø—Ä–æ—Å–µ\",",
									"        () => {",
									"    pm.expect(source.annotation).equal(target.annotation, '–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.category.id).equal(target.category.id, '–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.paid.toString()).equal(target.paid.toString(), '–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.eventDate).equal(target.eventDate, '–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.description).equal(target.description, '–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏—é —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.title).equal(target.title, '–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—é —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"    pm.expect(source.participantLimit.toString()).equal(target.participantLimit.toString(), '–õ–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º');",
									"        pm.expect(target.comments.length).equal(1);",
									"        pm.expect(target.comments[0].state).equal('ACCEPTED');",
									"});",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/events/:eventId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"events",
								":eventId"
							],
							"variable": [
								{
									"key": "eventId",
									"value": "{{eventId}}"
								}
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"API = class {",
					"    constructor(postman, verbose = false, baseUrl = \"http://localhost:8080\") {",
					"        this.baseUrl = baseUrl;",
					"        this.pm = postman;",
					"        this._verbose = verbose;",
					"    }",
					"",
					"    async addUser(user, verbose=null) {",
					"        return this.post(\"/admin/users\", user, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: \", verbose);",
					"    }",
					"",
					"    async addComment(comment, authorId, eventId, verbose=null) {",
					"        return this.post(\"/users/\" + authorId + \"/events/\" + eventId + \"/comments\", comment, verbose);",
					"    }",
					"",
					"    async acceptComment(comment, verbose=null) {",
					"        return this.patch(\"/admin/comments/\" + comment.id + \"/ACCEPTED\");",
					"    }",
					"",
					"    async addCategory(category, verbose=null) {",
					"        return this.post(\"/admin/categories\", category, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: \", verbose);",
					"    }",
					"",
					"    async addEvent(userId, event, verbose=null) {",
					"        return this.post(\"/users/\" + userId + \"/events\", event, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è: \", verbose);",
					"    }",
					"",
					"    async addCompilation(compilation, verbose=null) {",
					"        return this.post(\"/admin/compilations\", compilation, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –ø–æ–¥–±–æ—Ä–∫–∏: \", verbose);",
					"    }",
					"",
					"    async publishParticipationRequest(eventId, userId, verbose=null) {",
					"        return this.post('/users/' + userId + '/requests?eventId=' + eventId, null, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —É—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±—ã—Ç–∏–∏\", verbose);",
					"    }",
					"",
					"    async publishEvent(eventId, verbose=null) {",
					"        return this.patch('/admin/events/' + eventId, {stateAction: \"PUBLISH_EVENT\"}, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è\", verbose);",
					"    }",
					"    ",
					"    async rejectEvent(eventId, verbose=null) {",
					"        return this.patch('/admin/events/' + eventId, {stateAction: \"REJECT_EVENT\"}, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —Å–æ–±—ã—Ç–∏—è\", verbose);",
					"    }",
					"",
					"    async acceptParticipationRequest(eventId, userId, reqId, verbose=null) {",
					"        return this.patch('/users/' + userId + '/events/' + eventId + '/requests/', {requestIds:[reqId], status: \"CONFIRMED\"}, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∑–∞—è–≤–∫–∏ –Ω–∞ —É—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±—ã—Ç–∏–∏\", verbose);",
					"    }",
					"",
					"    async findCategory(catId, verbose=null) {",
					"        return this.get('/categories/' + catId, null, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ id\", verbose);",
					"    }",
					"",
					"    async findCompilation(compId, verbose=null) {",
					"        return this.get('/compilations/' + compId, null, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ–¥–±–æ—Ä–∫–∏ –ø–æ id\", verbose);",
					"    }",
					"",
					"    async findUser(userId, verbose=null) {",
					"        return this.get('/admin/users?ids=' + userId, null, \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ id\", verbose);",
					"    }",
					"",
					"    async post(path, body, errorText = \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ post-–∑–∞–ø—Ä–æ—Å–∞: \", verbose=null) {",
					"        return this.sendRequest(\"POST\", path, body, errorText, verbose);",
					"    }",
					"",
					"    async patch(path, body = null, errorText = \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ patch-–∑–∞–ø—Ä–æ—Å–∞: \", verbose=null) {",
					"        return this.sendRequest(\"PATCH\", path, body, errorText, verbose);",
					"    }",
					"",
					"    async get(path, body = null, errorText = \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ get-–∑–∞–ø—Ä–æ—Å–∞: \", verbose=null) {",
					"        return this.sendRequest(\"GET\", path, body, errorText, verbose);",
					"    }",
					"",
					"    async sendRequest(method, path, body=null, errorText = \"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞: \", verbose=null) {",
					"        return new Promise((resolve, reject) => {",
					"            verbose = verbose == null ? this._verbose : verbose;",
					"",
					"            const request = {",
					"                url: this.baseUrl + path,",
					"                method: method,",
					"                body: body == null ? \"\" : JSON.stringify(body),",
					"                header: { \"Content-Type\": \"application/json\" },",
					"            };",
					"",
					"            if(verbose) {",
					"                console.log(\"–û—Ç–ø—Ä–∞–≤–ª—è—é –∑–∞–ø—Ä–æ—Å: \", request);",
					"            }",
					"",
					"            try {",
					"                this.pm.sendRequest(request, (error, response) => {",
					"                    if(error || (response.code >= 400 && response.code <= 599)) {",
					"                        let err = error ? error : JSON.stringify(response.json());",
					"                        console.error(\"–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–∫–∞.\\n\", err,",
					"                             \"\\n–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–∞–∫–æ–π –∂–µ –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ \" + ",
					"                             \"–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞:\\n\", JSON.stringify(request));",
					"",
					"                        reject(new Error(errorText + err));",
					"                    }",
					"",
					"                    if(verbose) {",
					"                        console.log(\"–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞: –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è - \", response.code, \", —Ç–µ–ª–æ: \", response.json());",
					"                    }",
					"",
					"                    resolve(response.json());",
					"                });",
					"            } catch(err) {",
					"                if(verbose) {",
					"                    console.error(errorText, err);",
					"                }",
					"                return Promise.reject(err);",
					"            }",
					"        });",
					"    }",
					"};",
					"",
					"RandomUtils = class {",
					"    constructor() {}",
					"",
					"    getComment() {",
					"        return {",
					"            text: pm.variables.replaceIn('{{$randomWord}}')",
					"        };",
					"    }",
					"",
					"    getUser() {",
					"        return {",
					"            name: pm.variables.replaceIn('{{$randomFullName}}'),",
					"            email: pm.variables.replaceIn('{{$randomEmail}}')",
					"        };",
					"    }",
					"",
					"    getCategory() {",
					"        return {",
					"            name: pm.variables.replaceIn('{{$randomWord}}') + Math.floor(Math.random() * 100).toString()",
					"        };",
					"    }",
					"",
					"    getEvent(categoryId) {",
					"        return {",
					"            annotation: pm.variables.replaceIn('{{$randomLoremParagraph}}'),",
					"            category: categoryId,",
					"            description: pm.variables.replaceIn('{{$randomLoremParagraphs}}'),",
					"            eventDate: this.getFutureDateTime(),",
					"            location: {",
					"                lat: parseFloat(pm.variables.replaceIn('{{$randomLatitude}}')),",
					"                lon: parseFloat(pm.variables.replaceIn('{{$randomLongitude}}')),",
					"            },",
					"            paid: pm.variables.replaceIn('{{$randomBoolean}}'),",
					"            participantLimit: pm.variables.replaceIn('{{$randomInt}}'),",
					"            requestModeration: pm.variables.replaceIn('{{$randomBoolean}}'),",
					"            title: pm.variables.replaceIn('{{$randomLoremSentence}}'),",
					"        }",
					"    }",
					"",
					"    getCompilation(...eventIds) {",
					"        return {",
					"            title: pm.variables.replaceIn('{{$randomLoremSentence}}'),",
					"            pinned: pm.variables.replaceIn('{{$randomBoolean}}'),",
					"            events: eventIds",
					"        };",
					"    }",
					"",
					"    getFutureDateTime(hourShift = 5, minuteShift=0, yearShift=0) {",
					"        let moment = require('moment');",
					"",
					"        let m = moment();",
					"        m.add(hourShift, 'hour');",
					"        m.add(minuteShift, 'minute');",
					"        m.add(yearShift, 'year');",
					"",
					"        return m.format('YYYY-MM-DD HH:mm:ss');",
					"    }",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080"
		},
		{
			"key": "commentId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "commenterId",
			"value": "2",
			"type": "string"
		},
		{
			"key": "eventId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "createdComment",
			"value": ""
		},
		{
			"key": "fakeCommenterId",
			"value": ""
		},
		{
			"key": "comment",
			"value": ""
		},
		{
			"key": "pendingComments",
			"value": ""
		},
		{
			"key": "response",
			"value": ""
		}
	]
}